---
external help file: ConnectWiseAutomateAgent-help.xml
Module Name: ConnectWiseAutomateAgent
online version: https://github.com/christaylorcodes/ConnectWiseAutomateAgent
schema: 2.0.0
---

# Register-CWAAHealthCheckTask

## SYNOPSIS
Creates or updates a scheduled task for periodic ConnectWise Automate agent health checks.

## SYNTAX

```
Register-CWAAHealthCheckTask [-InstallerToken] <String> [[-Server] <String[]>] [[-LocationID] <Int32>]
 [[-TaskName] <String>] [[-IntervalHours] <Int32>] [-Force] [-ProgressAction <ActionPreference>] [-WhatIf]
 [-Confirm] [<CommonParameters>]
```

## DESCRIPTION
Creates a Windows scheduled task that runs Repair-CWAA at a configurable interval
(default every 6 hours) to monitor agent health and automatically remediate issues.

The task runs as SYSTEM with highest privileges, includes a random delay equal to the
interval to stagger execution across multiple machines, and has a 1-hour execution timeout.

If the task already exists and the InstallerToken has changed, the task is recreated
with the new token.
Use -Force to recreate unconditionally.

A backup of the current agent configuration is created before task registration
via New-CWAABackup.

## EXAMPLES

### EXAMPLE 1
```
Register-CWAAHealthCheckTask -InstallerToken 'abc123def456'
```

Creates a task that runs Repair-CWAA in Checkup mode every 6 hours.

### EXAMPLE 2
```
Register-CWAAHealthCheckTask -InstallerToken 'token' -Server 'https://automate.domain.com' -LocationID 42
```

Creates a task that runs Repair-CWAA in Install mode (can install fresh if agent is missing).

### EXAMPLE 3
```
Register-CWAAHealthCheckTask -InstallerToken 'token' -IntervalHours 12 -TaskName 'MyHealthCheck'
```

Creates a custom-named task running every 12 hours.

## PARAMETERS

### -Force
Force recreation of the task even if it already exists with the same token.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### -InstallerToken
The installer token for authenticated agent deployment.
Embedded in the scheduled
task action for use by Repair-CWAA.

```yaml
Type: String
Parameter Sets: (All)
Aliases:

Required: True
Position: 1
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -IntervalHours
Hours between health check runs.
Default: 6.

```yaml
Type: Int32
Parameter Sets: (All)
Aliases:

Required: False
Position: 5
Default value: 6
Accept pipeline input: False
Accept wildcard characters: False
```

### -LocationID
Optional location ID.
Required when Server is provided.

```yaml
Type: Int32
Parameter Sets: (All)
Aliases:

Required: False
Position: 3
Default value: 0
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### -ProgressAction
Determines how PowerShell responds to progress updates generated by a script, cmdlet, or provider.

```yaml
Type: ActionPreference
Parameter Sets: (All)
Aliases: proga

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Server
Optional server URL.
When provided, the scheduled task passes this to Repair-CWAA
in Install mode (with Server, LocationID, and InstallerToken).

```yaml
Type: String[]
Parameter Sets: (All)
Aliases:

Required: False
Position: 2
Default value: None
Accept pipeline input: True (ByPropertyName)
Accept wildcard characters: False
```

### -TaskName
Name of the scheduled task.
Default: 'AAutomate'.

```yaml
Type: String
Parameter Sets: (All)
Aliases:

Required: False
Position: 4
Default value: AAutomate
Accept pipeline input: False
Accept wildcard characters: False
```

### -Confirm
Prompts you for confirmation before running the cmdlet.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases: cf

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -WhatIf
Shows what would happen if the cmdlet runs.
The cmdlet is not run.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases: wi

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### CommonParameters
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see [about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

## OUTPUTS

## NOTES
Author: Chris Taylor
Alias: Register-LTHealthCheckTask

## RELATED LINKS

[https://github.com/christaylorcodes/ConnectWiseAutomateAgent](https://github.com/christaylorcodes/ConnectWiseAutomateAgent)

